{
  "$defs": {
    "AuthenticationVariable": {
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "value": {
          "title": "Value",
          "type": "string"
        }
      },
      "required": [
        "name",
        "value"
      ],
      "title": "AuthenticationVariable",
      "type": "object"
    },
    "BaseExtraction": {
      "properties": {
        "name": {
          "description": "The name of the variable to store the extracted value in",
          "title": "Name",
          "type": "string"
        }
      },
      "required": [
        "name"
      ],
      "title": "BaseExtraction",
      "type": "object"
    },
    "BasicRunnerConfiguration": {
      "properties": {
        "tech": {
          "const": "basic",
          "default": "basic",
          "title": "Tech"
        },
        "parameters": {
          "$ref": "#/$defs/HTTPRequestParameters"
        },
        "extractions": {
          "items": {
            "$ref": "#/$defs/BaseExtraction"
          },
          "title": "Extractions",
          "type": "array"
        },
        "name": {
          "title": "Name",
          "type": "string"
        }
      },
      "required": [
        "parameters",
        "name"
      ],
      "title": "BasicRunnerConfiguration",
      "type": "object"
    },
    "Credentials": {
      "properties": {
        "username": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The username to attach to the HTTP requests sent for this user. See https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication#access_using_credentials_in_the_url",
          "title": "Username"
        },
        "password": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The password to attach to the HTTP requests sent for this user. See https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication#access_using_credentials_in_the_url",
          "title": "Password"
        },
        "headers": {
          "description": "A list of headers to attach to every HTTP requests sent for this user",
          "items": {
            "$ref": "#/$defs/HTTPHeader"
          },
          "title": "Headers",
          "type": "array"
        },
        "cookies": {
          "description": "A list of cookies to attach to every HTTP requests sent for this user",
          "items": {
            "$ref": "#/$defs/HTTPCookie"
          },
          "title": "Cookies",
          "type": "array"
        },
        "query_parameters": {
          "description": "A list of query parameters to attach to every HTTP requests sent for this user",
          "items": {
            "$ref": "#/$defs/HTTPQueryParameter"
          },
          "title": "Query Parameters",
          "type": "array"
        },
        "body": {
          "anyOf": [
            {},
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A body to merge with the bodies of every HTTP requests sent for this user",
          "title": "Body"
        }
      },
      "title": "Credentials",
      "type": "object"
    },
    "GraphQLRequestParameters": {
      "properties": {
        "url": {
          "title": "Url",
          "type": "string"
        },
        "method": {
          "allOf": [
            {
              "$ref": "#/$defs/HTTPMethod"
            }
          ],
          "default": "POST"
        },
        "headers": {
          "items": {
            "$ref": "#/$defs/HTTPHeader"
          },
          "title": "Headers",
          "type": "array"
        },
        "cookies": {
          "items": {
            "$ref": "#/$defs/HTTPCookie"
          },
          "title": "Cookies",
          "type": "array"
        },
        "query_parameters": {
          "items": {
            "$ref": "#/$defs/HTTPQueryParameter"
          },
          "title": "Query Parameters",
          "type": "array"
        },
        "body": {
          "anyOf": [
            {},
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Body"
        },
        "proxy": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Proxy"
        },
        "query": {
          "title": "Query",
          "type": "string"
        },
        "variables": {
          "items": {
            "$ref": "#/$defs/GraphQLVariable"
          },
          "title": "Variables",
          "type": "array"
        }
      },
      "required": [
        "url",
        "query"
      ],
      "title": "GraphQLRequestParameters",
      "type": "object"
    },
    "GraphQLRunnerConfiguration": {
      "properties": {
        "tech": {
          "const": "graphql",
          "default": "graphql",
          "title": "Tech"
        },
        "parameters": {
          "$ref": "#/$defs/GraphQLRequestParameters"
        },
        "extractions": {
          "items": {
            "discriminator": {
              "mapping": {
                "body": "#/$defs/HTTPBodyExtraction",
                "cookie": "#/$defs/HTTPCookieExtraction",
                "header": "#/$defs/HTTPHeaderExtraction"
              },
              "propertyName": "location"
            },
            "oneOf": [
              {
                "$ref": "#/$defs/HTTPHeaderExtraction"
              },
              {
                "$ref": "#/$defs/HTTPCookieExtraction"
              },
              {
                "$ref": "#/$defs/HTTPBodyExtraction"
              }
            ]
          },
          "title": "Extractions",
          "type": "array"
        }
      },
      "required": [
        "parameters"
      ],
      "title": "GraphQLRunnerConfiguration",
      "type": "object"
    },
    "GraphQLVariable": {
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "value": {
          "title": "Value"
        }
      },
      "required": [
        "name",
        "value"
      ],
      "title": "GraphQLVariable",
      "type": "object"
    },
    "HTTPBodyExtraction": {
      "properties": {
        "name": {
          "description": "The name of the variable to store the extracted value in",
          "title": "Name",
          "type": "string"
        },
        "location": {
          "const": "body",
          "default": "body",
          "title": "Location"
        },
        "key": {
          "description": "The key to extract the value from the body. The key is searched recursively.",
          "title": "Key",
          "type": "string"
        }
      },
      "required": [
        "name",
        "key"
      ],
      "title": "HTTPBodyExtraction",
      "type": "object"
    },
    "HTTPCookie": {
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "values": {
          "items": {
            "type": "string"
          },
          "title": "Values",
          "type": "array"
        }
      },
      "required": [
        "name",
        "values"
      ],
      "title": "HTTPCookie",
      "type": "object"
    },
    "HTTPCookieExtraction": {
      "properties": {
        "name": {
          "description": "The name of the variable to store the extracted value in",
          "title": "Name",
          "type": "string"
        },
        "location": {
          "const": "cookie",
          "default": "cookie",
          "title": "Location"
        },
        "key": {
          "description": "The name of the cookie to extract the value from",
          "title": "Key",
          "type": "string"
        }
      },
      "required": [
        "name",
        "key"
      ],
      "title": "HTTPCookieExtraction",
      "type": "object"
    },
    "HTTPHeader": {
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "values": {
          "items": {
            "type": "string"
          },
          "title": "Values",
          "type": "array"
        }
      },
      "required": [
        "name",
        "values"
      ],
      "title": "HTTPHeader",
      "type": "object"
    },
    "HTTPHeaderExtraction": {
      "properties": {
        "name": {
          "description": "The name of the variable to store the extracted value in",
          "title": "Name",
          "type": "string"
        },
        "location": {
          "const": "header",
          "default": "header",
          "title": "Location"
        },
        "key": {
          "description": "The name of the header to extract the value from",
          "title": "Key",
          "type": "string"
        }
      },
      "required": [
        "name",
        "key"
      ],
      "title": "HTTPHeaderExtraction",
      "type": "object"
    },
    "HTTPLocation": {
      "enum": [
        "header",
        "cookie",
        "body",
        "query"
      ],
      "title": "HTTPLocation",
      "type": "string"
    },
    "HTTPMethod": {
      "description": "HTTP methods and descriptions\n\nMethods from the following RFCs are all observed:\n\n    * RFC 7231: Hypertext Transfer Protocol (HTTP/1.1), obsoletes 2616\n    * RFC 5789: PATCH Method for HTTP",
      "enum": [
        "CONNECT",
        "DELETE",
        "GET",
        "HEAD",
        "OPTIONS",
        "PATCH",
        "POST",
        "PUT",
        "TRACE"
      ],
      "title": "HTTPMethod",
      "type": "string"
    },
    "HTTPQueryParameter": {
      "properties": {
        "name": {
          "title": "Name",
          "type": "string"
        },
        "values": {
          "items": {
            "type": "string"
          },
          "title": "Values",
          "type": "array"
        }
      },
      "required": [
        "name",
        "values"
      ],
      "title": "HTTPQueryParameter",
      "type": "object"
    },
    "HTTPRequestParameters": {
      "properties": {
        "url": {
          "title": "Url",
          "type": "string"
        },
        "method": {
          "$ref": "#/$defs/HTTPMethod"
        },
        "headers": {
          "items": {
            "$ref": "#/$defs/HTTPHeader"
          },
          "title": "Headers",
          "type": "array"
        },
        "cookies": {
          "items": {
            "$ref": "#/$defs/HTTPCookie"
          },
          "title": "Cookies",
          "type": "array"
        },
        "query_parameters": {
          "items": {
            "$ref": "#/$defs/HTTPQueryParameter"
          },
          "title": "Query Parameters",
          "type": "array"
        },
        "body": {
          "anyOf": [
            {},
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Body"
        },
        "proxy": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Proxy"
        }
      },
      "required": [
        "url",
        "method"
      ],
      "title": "HTTPRequestParameters",
      "type": "object"
    },
    "HTTPRunnerConfiguration": {
      "properties": {
        "tech": {
          "const": "http",
          "default": "http",
          "title": "Tech"
        },
        "parameters": {
          "$ref": "#/$defs/HTTPRequestParameters"
        },
        "extractions": {
          "items": {
            "discriminator": {
              "mapping": {
                "body": "#/$defs/HTTPBodyExtraction",
                "cookie": "#/$defs/HTTPCookieExtraction",
                "header": "#/$defs/HTTPHeaderExtraction"
              },
              "propertyName": "location"
            },
            "oneOf": [
              {
                "$ref": "#/$defs/HTTPHeaderExtraction"
              },
              {
                "$ref": "#/$defs/HTTPCookieExtraction"
              },
              {
                "$ref": "#/$defs/HTTPBodyExtraction"
              }
            ]
          },
          "title": "Extractions",
          "type": "array"
        }
      },
      "required": [
        "parameters"
      ],
      "title": "HTTPRunnerConfiguration",
      "type": "object"
    },
    "JWTAccessTokenRefreshTokenPreset": {
      "properties": {
        "type": {
          "const": "jwt_access_token_refresh_token",
          "default": "jwt_access_token_refresh_token",
          "title": "Type"
        },
        "name": {
          "description": "The name of the preset. Will be the name of the generated procedure.",
          "title": "Name",
          "type": "string"
        },
        "parameters": {
          "$ref": "#/$defs/HTTPRequestParameters"
        }
      },
      "required": [
        "name",
        "parameters"
      ],
      "title": "JWTAccessTokenRefreshTokenPreset",
      "type": "object"
    },
    "OAuthUserpassPreset": {
      "properties": {
        "type": {
          "const": "oauth_userpass",
          "default": "oauth_userpass",
          "title": "Type"
        },
        "name": {
          "description": "The name of the preset. Will be the name of the generated procedure.",
          "title": "Name",
          "type": "string"
        },
        "server_url": {
          "description": "The URL of the token endpoint of the OpenIDConnect server",
          "title": "Server Url",
          "type": "string"
        },
        "client_id": {
          "description": "The client ID to use for the OAuth requests",
          "title": "Client Id",
          "type": "string"
        },
        "client_secret": {
          "description": "The client secret to use for the OAuth requests",
          "title": "Client Secret",
          "type": "string"
        },
        "users": {
          "description": "A list of users to create",
          "items": {
            "maxItems": 2,
            "minItems": 2,
            "prefixItems": [
              {
                "type": "string"
              },
              {
                "type": "string"
              }
            ],
            "type": "array"
          },
          "title": "Users",
          "type": "array"
        }
      },
      "required": [
        "name",
        "server_url",
        "client_id",
        "client_secret"
      ],
      "title": "OAuthUserpassPreset",
      "type": "object"
    },
    "ProcedureConfiguration": {
      "properties": {
        "name": {
          "description": "The name of the procedure.",
          "title": "Name",
          "type": "string"
        },
        "requests": {
          "items": {
            "discriminator": {
              "mapping": {
                "basic": "#/$defs/BasicRunnerConfiguration",
                "graphql": "#/$defs/GraphQLRunnerConfiguration",
                "http": "#/$defs/HTTPRunnerConfiguration",
                "selenium": "#/$defs/SeleniumRunnerConfiguration"
              },
              "propertyName": "tech"
            },
            "oneOf": [
              {
                "$ref": "#/$defs/HTTPRunnerConfiguration"
              },
              {
                "$ref": "#/$defs/GraphQLRunnerConfiguration"
              },
              {
                "$ref": "#/$defs/BasicRunnerConfiguration"
              },
              {
                "$ref": "#/$defs/SeleniumRunnerConfiguration"
              }
            ]
          },
          "title": "Requests",
          "type": "array"
        }
      },
      "required": [
        "name"
      ],
      "title": "ProcedureConfiguration",
      "type": "object"
    },
    "SeleniumCommand": {
      "properties": {
        "id": {
          "title": "Id",
          "type": "string"
        },
        "command": {
          "title": "Command",
          "type": "string"
        },
        "target": {
          "title": "Target",
          "type": "string"
        },
        "targets": {
          "items": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "title": "Targets",
          "type": "array"
        },
        "value": {
          "title": "Value",
          "type": "string"
        }
      },
      "required": [
        "id",
        "command",
        "target",
        "targets",
        "value"
      ],
      "title": "SeleniumCommand",
      "type": "object"
    },
    "SeleniumExtraction": {
      "properties": {
        "name": {
          "description": "The name of the variable to store the extracted value in",
          "title": "Name",
          "type": "string"
        },
        "extract_location": {
          "enum": [
            "RequestURL",
            "RequestHeader",
            "RequestBody",
            "ResponseHeader",
            "ResponseBody"
          ],
          "title": "Extract Location",
          "type": "string"
        },
        "extract_regex": {
          "title": "Extract Regex",
          "type": "string"
        },
        "extract_match_index": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Extract Match Index"
        }
      },
      "required": [
        "name",
        "extract_location",
        "extract_regex"
      ],
      "title": "SeleniumExtraction",
      "type": "object"
    },
    "SeleniumProject": {
      "properties": {
        "tests": {
          "items": {
            "$ref": "#/$defs/SeleniumTest"
          },
          "title": "Tests",
          "type": "array"
        }
      },
      "required": [
        "tests"
      ],
      "title": "SeleniumProject",
      "type": "object"
    },
    "SeleniumRunnerConfiguration": {
      "properties": {
        "tech": {
          "const": "selenium",
          "default": "selenium",
          "title": "Tech"
        },
        "parameters": {
          "$ref": "#/$defs/SeleniumScriptParameters"
        },
        "extractions": {
          "items": {
            "$ref": "#/$defs/SeleniumExtraction"
          },
          "title": "Extractions",
          "type": "array"
        }
      },
      "required": [
        "parameters",
        "extractions"
      ],
      "title": "SeleniumRunnerConfiguration",
      "type": "object"
    },
    "SeleniumScriptOptions": {
      "properties": {
        "token_lifetime": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Token Lifetime"
        },
        "proxy": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Proxy"
        }
      },
      "title": "SeleniumScriptOptions",
      "type": "object"
    },
    "SeleniumScriptParameters": {
      "description": "SeleniumScriptParameters(*, project: multiauth.revamp.lib.runners.webdriver.configuration.SeleniumProject, options: multiauth.revamp.lib.runners.webdriver.runner.SeleniumScriptOptions)",
      "properties": {
        "project": {
          "$ref": "#/$defs/SeleniumProject"
        },
        "options": {
          "$ref": "#/$defs/SeleniumScriptOptions"
        }
      },
      "required": [
        "project",
        "options"
      ],
      "title": "SeleniumScriptParameters",
      "type": "object"
    },
    "SeleniumTest": {
      "properties": {
        "id": {
          "title": "Id",
          "type": "string"
        },
        "name": {
          "title": "Name",
          "type": "string"
        },
        "commands": {
          "items": {
            "$ref": "#/$defs/SeleniumCommand"
          },
          "title": "Commands",
          "type": "array"
        }
      },
      "required": [
        "id",
        "name",
        "commands"
      ],
      "title": "SeleniumTest",
      "type": "object"
    },
    "TokenInjection": {
      "properties": {
        "location": {
          "allOf": [
            {
              "$ref": "#/$defs/HTTPLocation"
            }
          ],
          "description": "The location of the HTTP request where the token should be injected"
        },
        "key": {
          "description": "The key to use for the injected token. Its usage depends on the location. For headers, cookies,and query parameters, this key describes the name of the header, cookie or query parameter. For a body location, the key is the field where the token should be injected within the request bodies",
          "examples": [
            "Authorization",
            "sessionId",
            "access_token"
          ],
          "title": "Key",
          "type": "string"
        },
        "prefix": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A prefix to prepend to the token before it is injected",
          "examples": [
            "Bearer "
          ],
          "title": "Prefix"
        },
        "variable": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The name of a variable to retrieve to create the token's value. If not provided, the token will be infered as the first successful extraction of the procedure",
          "title": "Variable"
        }
      },
      "required": [
        "location",
        "key"
      ],
      "title": "TokenInjection",
      "type": "object"
    },
    "User": {
      "properties": {
        "name": {
          "description": "The name of the user",
          "title": "Name",
          "type": "string"
        },
        "credentials": {
          "allOf": [
            {
              "$ref": "#/$defs/Credentials"
            }
          ],
          "description": "The parameters use to customize requests sent for the user"
        },
        "authentication": {
          "allOf": [
            {
              "$ref": "#/$defs/UserAuthentication"
            }
          ],
          "description": "The authentication parameters of the user, including the authentication procedure to followand the description of how retrieved tokens should be injected in the user authentication result"
        },
        "variables": {
          "description": "List of variables that will be injected at the beginning of the user's authentication procedure",
          "items": {
            "$ref": "#/$defs/AuthenticationVariable"
          },
          "title": "Variables",
          "type": "array"
        },
        "refresh": {
          "anyOf": [
            {
              "$ref": "#/$defs/UserRefresh"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "An optional refresh procedure to follow for the user"
        }
      },
      "required": [
        "name",
        "credentials",
        "authentication"
      ],
      "title": "User",
      "type": "object"
    },
    "UserAuthentication": {
      "properties": {
        "procedure": {
          "description": "The name of the procedure to use to authenticate the user.This name MUST match the `name` field of a procedure in the `procedures` list in the multiauth configuration.",
          "title": "Procedure",
          "type": "string"
        },
        "injections": {
          "description": "List of variables injections to perform to create the authentication.",
          "items": {
            "$ref": "#/$defs/TokenInjection"
          },
          "title": "Injections",
          "type": "array"
        }
      },
      "required": [
        "procedure",
        "injections"
      ],
      "title": "UserAuthentication",
      "type": "object"
    },
    "UserRefresh": {
      "properties": {
        "procedure": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Procedure to use to refresh the authentication.Defaults to the user procedure if not provided. This name MUST match the `name` field of a procedure in the `procedures` list in the multiauth configuration.",
          "title": "Procedure"
        },
        "session_seconds": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Number of seconds to wait before refreshing the authentication. If not provided, multiauth willtry to infer the session duration from the returned variables",
          "title": "Session Seconds"
        },
        "injections": {
          "description": "List of injections to perform to create the refreshed authentication. If empty, the user's injections will be used to recreate an authentication object.",
          "items": {
            "$ref": "#/$defs/TokenInjection"
          },
          "title": "Injections",
          "type": "array"
        },
        "keep": {
          "default": false,
          "description": "If true, multiauth will keep the current tokens and use a merge of the refreshed authenticationand the current one.",
          "title": "Keep",
          "type": "boolean"
        },
        "credentials": {
          "anyOf": [
            {
              "$ref": "#/$defs/Credentials"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Credentials to use to refresh the authentication. If not provided, the user credentials will be used."
        },
        "variables": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/AuthenticationVariable"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "List of variables that will be injected at the beginning of the user'srefresh procedure. If not provided, the user's variables will be used instead.",
          "title": "Variables"
        }
      },
      "title": "UserRefresh",
      "type": "object"
    }
  },
  "description": "Multiauth configuration model.",
  "properties": {
    "procedures": {
      "description": "The list of authentication procedures to use",
      "items": {
        "$ref": "#/$defs/ProcedureConfiguration"
      },
      "title": "Procedures",
      "type": "array"
    },
    "presets": {
      "description": "The list of presets to use",
      "items": {
        "discriminator": {
          "mapping": {
            "jwt_access_token_refresh_token": "#/$defs/JWTAccessTokenRefreshTokenPreset",
            "oauth_userpass": "#/$defs/OAuthUserpassPreset"
          },
          "propertyName": "type"
        },
        "oneOf": [
          {
            "$ref": "#/$defs/JWTAccessTokenRefreshTokenPreset"
          },
          {
            "$ref": "#/$defs/OAuthUserpassPreset"
          }
        ]
      },
      "title": "Presets",
      "type": "array"
    },
    "users": {
      "description": "List of users that can be used in procedures",
      "items": {
        "$ref": "#/$defs/User"
      },
      "title": "Users",
      "type": "array"
    }
  },
  "title": "MultiauthConfiguration",
  "type": "object"
}